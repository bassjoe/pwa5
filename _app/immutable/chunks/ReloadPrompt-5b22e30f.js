import{S as U,i as B,s as C,e as N,b as w,B as E,h as _,E as P,k as g,a as A,q as y,l as R,m as b,c as I,r as S,n as k,D as h,M as D}from"./index-46fdc337.js";import{_ as V}from"./preload-helper-b21cceae.js";import{w as O}from"./singletons-e33c6b31.js";function j(s={}){const{immediate:e=!1,onNeedRefresh:t,onOfflineReady:o,onRegistered:i,onRegisteredSW:n,onRegisterError:a}=s;let c,u,v,m;const r=async(d=!0)=>{await v,d&&(c==null||c.addEventListener("controlling",f=>{f.isUpdate&&window.location.reload()})),await(m==null?void 0:m())};async function l(){if("serviceWorker"in navigator){const{Workbox:d,messageSW:f}=await V(()=>import("./workbox-window.prod.es5-5729c1a5.js"),[],import.meta.url);m=async()=>{u&&u.waiting&&await f(u.waiting,{type:"SKIP_WAITING"})},c=new d("./sw.js",{scope:"./",type:"classic"}),c.addEventListener("activated",p=>{p.isUpdate||o==null||o()});{const p=()=>{t==null||t()};c.addEventListener("waiting",p),c.addEventListener("externalwaiting",p)}c.register({immediate:e}).then(p=>{u=p,n?n("./sw.js",p):i==null||i(p)}).catch(p=>{a==null||a(p)})}}return v=l(),r}function q(s={}){const{immediate:e=!0,onNeedRefresh:t,onOfflineReady:o,onRegistered:i,onRegisteredSW:n,onRegisterError:a}=s,c=O(!1),u=O(!1),v=j({immediate:e,onOfflineReady(){u.set(!0),o==null||o()},onNeedRefresh(){c.set(!0),t==null||t()},onRegistered:i,onRegisteredSW:n,onRegisterError:a});return{needRefresh:c,offlineReady:u,updateServiceWorker:v}}function T(s){let e,t,o,i,n,a,c,u;function v(d,f){return d[1]?G:M}let m=v(s),r=m(s),l=s[0]&&L(s);return{c(){e=g("div"),t=g("div"),r.c(),o=A(),l&&l.c(),i=A(),n=g("button"),a=y("Close"),this.h()},l(d){e=R(d,"DIV",{class:!0,role:!0});var f=b(e);t=R(f,"DIV",{class:!0});var p=b(t);r.l(p),p.forEach(_),o=I(f),l&&l.l(f),i=I(f),n=R(f,"BUTTON",{class:!0});var W=b(n);a=S(W,"Close"),W.forEach(_),f.forEach(_),this.h()},h(){k(t,"class","message svelte-141ior1"),k(n,"class","svelte-141ior1"),k(e,"class","pwa-toast svelte-141ior1"),k(e,"role","alert")},m(d,f){w(d,e,f),h(e,t),r.m(t,null),h(e,o),l&&l.m(e,null),h(e,i),h(e,n),h(n,a),c||(u=D(n,"click",s[6]),c=!0)},p(d,f){m!==(m=v(d))&&(r.d(1),r=m(d),r&&(r.c(),r.m(t,null))),d[0]?l?l.p(d,f):(l=L(d),l.c(),l.m(e,i)):l&&(l.d(1),l=null)},d(d){d&&_(e),r.d(),l&&l.d(),c=!1,u()}}}function M(s){let e,t;return{c(){e=g("span"),t=y("New content available, click on reload button to update.")},l(o){e=R(o,"SPAN",{});var i=b(e);t=S(i,"New content available, click on reload button to update."),i.forEach(_)},m(o,i){w(o,e,i),h(e,t)},d(o){o&&_(e)}}}function G(s){let e,t;return{c(){e=g("span"),t=y("App ready to work offline")},l(o){e=R(o,"SPAN",{});var i=b(e);t=S(i,"App ready to work offline"),i.forEach(_)},m(o,i){w(o,e,i),h(e,t)},d(o){o&&_(e)}}}function L(s){let e,t,o,i;return{c(){e=g("button"),t=y("Reload"),this.h()},l(n){e=R(n,"BUTTON",{class:!0});var a=b(e);t=S(a,"Reload"),a.forEach(_),this.h()},h(){k(e,"class","svelte-141ior1")},m(n,a){w(n,e,a),h(e,t),o||(i=D(e,"click",s[7]),o=!0)},p:E,d(n){n&&_(e),o=!1,i()}}}function K(s){let e,t=s[2]&&T(s);return{c(){t&&t.c(),e=N()},l(o){t&&t.l(o),e=N()},m(o,i){t&&t.m(o,i),w(o,e,i)},p(o,[i]){o[2]?t?t.p(o,i):(t=T(o),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:E,o:E,d(o){t&&t.d(o),o&&_(e)}}}function z(s,e,t){let o,i,n;const{needRefresh:a,updateServiceWorker:c,offlineReady:u}=q({onRegistered(r){console.log(`SW Registered: ${r}`)},onRegisterError(r){console.log("SW registration error",r)}});P(s,a,r=>t(0,i=r)),P(s,u,r=>t(1,n=r));const v=()=>{u.set(!1),a.set(!1)},m=()=>c(!0);return s.$$.update=()=>{s.$$.dirty&3&&t(2,o=n||i)},[i,n,o,a,c,u,v,m]}class Q extends U{constructor(e){super(),B(this,e,z,K,C,{})}}export{Q as default};
